---
title: 'Computing the k-mer replacement matrix by simulation'
output: rmarkdown::html_vignette
date: '2/27/2020'
author: 'Wuming Gong'
---

```{r, message = FALSE}
devtools::document('.')
devtools::load_all('.')
options(width = as.integer(system('tput cols', intern = TRUE)))
```

## Load the Challenge 2 lineage data
```{r}
data(lineages)
x <- lineages[[1]]$sequence
y <- lineages[[1]]$tree
```

## Distance estimation by 2-mer replacment frequency from the simulated data
```{r}
devtools::load_all('.')
S <- compute_replacement_matrix(x = x, n_batch = 10, n_cells_per_batch = 200, k = 2, mc.cores = 8)
x %>% 
	dist_replacement(S) %>% 
	fastme.bal() %>% 
	RF.dist(y, normalize = TRUE)
```

